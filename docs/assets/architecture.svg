<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 420" fill="none">
  <defs>
    <linearGradient id="bgA" x1="0" y1="0" x2="900" y2="420" gradientUnits="userSpaceOnUse">
      <stop offset="0%" stop-color="#0d1117"/>
      <stop offset="100%" stop-color="#161b22"/>
    </linearGradient>
    <linearGradient id="teal" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#0f8b8d"/>
      <stop offset="100%" stop-color="#0ea5a7"/>
    </linearGradient>
    <linearGradient id="orange" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#f48b4a"/>
      <stop offset="100%" stop-color="#f6a06b"/>
    </linearGradient>
    <linearGradient id="blue" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#58a6ff"/>
      <stop offset="100%" stop-color="#79c0ff"/>
    </linearGradient>
    <linearGradient id="purple" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#7c3aed"/>
      <stop offset="100%" stop-color="#a78bfa"/>
    </linearGradient>
    <filter id="glow">
      <feGaussianBlur stdDeviation="3" result="blur"/>
      <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
    <filter id="softglow">
      <feGaussianBlur stdDeviation="20"/>
    </filter>
  </defs>

  <style>
    @keyframes flowRight { 0% { stroke-dashoffset: 24; } 100% { stroke-dashoffset: 0; } }
    @keyframes flowDown { 0% { stroke-dashoffset: 24; } 100% { stroke-dashoffset: 0; } }
    @keyframes blink { 0%,100% { opacity: 0.4; } 50% { opacity: 1; } }
    .flow { stroke-dasharray: 8 4; animation: flowRight 1.5s linear infinite; }
    .flowv { stroke-dasharray: 8 4; animation: flowDown 1.5s linear infinite; }
    .blink { animation: blink 2s ease-in-out infinite; }
    .label { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
  </style>

  <!-- Background -->
  <rect width="900" height="420" fill="url(#bgA)" rx="12"/>

  <!-- Ambient glow -->
  <circle cx="200" cy="200" r="150" fill="#0f8b8d" opacity="0.05" filter="url(#softglow)"/>
  <circle cx="700" cy="200" r="150" fill="#f48b4a" opacity="0.05" filter="url(#softglow)"/>

  <!-- Title -->
  <text class="label" x="450" y="36" fill="#e6edf3" font-size="16" font-weight="700" text-anchor="middle" letter-spacing="0.1em">ARCHITECTURE</text>

  <!-- === WINDOWS LAYER === -->
  <rect x="40" y="65" width="200" height="155" rx="10" fill="#0f8b8d" opacity="0.08" stroke="#0f8b8d" stroke-width="1.5"/>
  <text class="label" x="140" y="88" fill="#0f8b8d" font-size="13" font-weight="700" text-anchor="middle">WINDOWS HOST</text>

  <!-- Collector box -->
  <rect x="60" y="100" width="160" height="50" rx="8" fill="#0f8b8d" opacity="0.15" stroke="#0f8b8d" stroke-width="1"/>
  <text class="label" x="140" y="120" fill="#e6edf3" font-size="12" font-weight="600" text-anchor="middle">Rust Collector</text>
  <text class="label" x="140" y="138" fill="#8b949e" font-size="10" text-anchor="middle">Win32 + UIA APIs</text>

  <!-- Event types -->
  <g transform="translate(65, 162)">
    <rect width="46" height="18" rx="9" fill="#0f8b8d" opacity="0.25"/>
    <text class="label" x="23" y="13" fill="#0f8b8d" font-size="9" font-weight="600" text-anchor="middle">FG</text>
    <rect x="52" width="46" height="18" rx="9" fill="#0f8b8d" opacity="0.25"/>
    <text class="label" x="75" y="13" fill="#0f8b8d" font-size="9" font-weight="600" text-anchor="middle">IDLE</text>
    <rect x="104" width="46" height="18" rx="9" fill="#0f8b8d" opacity="0.25"/>
    <text class="label" x="127" y="13" fill="#0f8b8d" font-size="9" font-weight="600" text-anchor="middle">UIA</text>
  </g>

  <!-- Status dot -->
  <circle class="blink" cx="215" cy="78" r="4" fill="#0f8b8d" filter="url(#glow)"/>

  <!-- === FLOW: Collector -> Backend === -->
  <line class="flow" x1="240" y1="125" x2="330" y2="125" stroke="#0f8b8d" stroke-width="2"/>
  <text class="label" x="285" y="115" fill="#8b949e" font-size="9" text-anchor="middle">WebSocket</text>
  <text class="label" x="285" y="142" fill="#8b949e" font-size="9" text-anchor="middle">/ingest</text>

  <!-- === WSL2 BACKEND === -->
  <rect x="330" y="65" width="240" height="290" rx="10" fill="#f48b4a" opacity="0.06" stroke="#f48b4a" stroke-width="1.5"/>
  <text class="label" x="450" y="88" fill="#f48b4a" font-size="13" font-weight="700" text-anchor="middle">WSL2 BACKEND</text>

  <!-- FastAPI -->
  <rect x="350" y="100" width="200" height="40" rx="8" fill="#f48b4a" opacity="0.15" stroke="#f48b4a" stroke-width="1"/>
  <text class="label" x="450" y="120" fill="#e6edf3" font-size="12" font-weight="600" text-anchor="middle">FastAPI Server</text>
  <text class="label" x="450" y="133" fill="#8b949e" font-size="9" text-anchor="middle">40+ endpoints</text>

  <!-- State Store -->
  <rect x="350" y="152" width="95" height="36" rx="6" fill="#f48b4a" opacity="0.1" stroke="#f48b4a" stroke-width="0.8"/>
  <text class="label" x="397" y="174" fill="#e6edf3" font-size="10" font-weight="500" text-anchor="middle">State Store</text>

  <!-- Classifier -->
  <rect x="455" y="152" width="95" height="36" rx="6" fill="#f48b4a" opacity="0.1" stroke="#f48b4a" stroke-width="0.8"/>
  <text class="label" x="502" y="174" fill="#e6edf3" font-size="10" font-weight="500" text-anchor="middle">Classifier</text>

  <!-- SQLite -->
  <rect x="350" y="200" width="95" height="36" rx="6" fill="#f48b4a" opacity="0.1" stroke="#f48b4a" stroke-width="0.8"/>
  <text class="label" x="397" y="222" fill="#e6edf3" font-size="10" font-weight="500" text-anchor="middle">SQLite</text>

  <!-- Auth -->
  <rect x="455" y="200" width="95" height="36" rx="6" fill="#f48b4a" opacity="0.1" stroke="#f48b4a" stroke-width="0.8"/>
  <text class="label" x="502" y="222" fill="#e6edf3" font-size="10" font-weight="500" text-anchor="middle">Token Auth</text>

  <!-- Autonomy Engine -->
  <rect x="350" y="250" width="200" height="48" rx="8" fill="#7c3aed" opacity="0.15" stroke="#7c3aed" stroke-width="1"/>
  <text class="label" x="450" y="272" fill="#e6edf3" font-size="12" font-weight="600" text-anchor="middle">Autonomy Engine</text>
  <text class="label" x="450" y="288" fill="#8b949e" font-size="9" text-anchor="middle">Planner &#x2192; Executor &#x2192; Verifier</text>

  <!-- Task Orchestrator -->
  <rect x="350" y="308" width="200" height="36" rx="6" fill="#7c3aed" opacity="0.1" stroke="#7c3aed" stroke-width="0.8"/>
  <text class="label" x="450" y="330" fill="#e6edf3" font-size="10" font-weight="500" text-anchor="middle">Task Orchestrator</text>

  <!-- Status dot -->
  <circle class="blink" cx="565" cy="78" r="4" fill="#f48b4a" filter="url(#glow)"/>

  <!-- === FLOW: Backend -> Web UI === -->
  <line class="flow" x1="570" y1="125" x2="660" y2="125" stroke="#58a6ff" stroke-width="2"/>
  <text class="label" x="615" y="115" fill="#8b949e" font-size="9" text-anchor="middle">WebSocket</text>
  <text class="label" x="615" y="142" fill="#8b949e" font-size="9" text-anchor="middle">/ws</text>

  <!-- === WEB UI === -->
  <rect x="660" y="65" width="200" height="155" rx="10" fill="#58a6ff" opacity="0.06" stroke="#58a6ff" stroke-width="1.5"/>
  <text class="label" x="760" y="88" fill="#58a6ff" font-size="13" font-weight="700" text-anchor="middle">WEB UI</text>

  <!-- Live Dashboard -->
  <rect x="680" y="100" width="160" height="40" rx="8" fill="#58a6ff" opacity="0.15" stroke="#58a6ff" stroke-width="1"/>
  <text class="label" x="760" y="120" fill="#e6edf3" font-size="12" font-weight="600" text-anchor="middle">Live Dashboard</text>
  <text class="label" x="760" y="133" fill="#8b949e" font-size="9" text-anchor="middle">Real-time streaming</text>

  <!-- UI features -->
  <g transform="translate(685, 152)">
    <rect width="70" height="18" rx="9" fill="#58a6ff" opacity="0.2"/>
    <text class="label" x="35" y="13" fill="#58a6ff" font-size="9" font-weight="600" text-anchor="middle">Events</text>
    <rect x="76" width="70" height="18" rx="9" fill="#58a6ff" opacity="0.2"/>
    <text class="label" x="111" y="13" fill="#58a6ff" font-size="9" font-weight="600" text-anchor="middle">Controls</text>
  </g>
  <g transform="translate(685, 176)">
    <rect width="70" height="18" rx="9" fill="#58a6ff" opacity="0.2"/>
    <text class="label" x="35" y="13" fill="#58a6ff" font-size="9" font-weight="600" text-anchor="middle">Telemetry</text>
    <rect x="76" width="70" height="18" rx="9" fill="#58a6ff" opacity="0.2"/>
    <text class="label" x="111" y="13" fill="#58a6ff" font-size="9" font-weight="600" text-anchor="middle">Voice</text>
  </g>

  <!-- Status dot -->
  <circle class="blink" cx="855" cy="78" r="4" fill="#58a6ff" filter="url(#glow)"/>

  <!-- === OPTIONAL: Ollama === -->
  <rect x="660" y="260" width="200" height="80" rx="10" fill="#7c3aed" opacity="0.06" stroke="#7c3aed" stroke-width="1" stroke-dasharray="4 3"/>
  <text class="label" x="760" y="283" fill="#7c3aed" font-size="13" font-weight="700" text-anchor="middle">OLLAMA</text>
  <text class="label" x="760" y="300" fill="#8b949e" font-size="10" text-anchor="middle">Local LLM (optional)</text>
  <text class="label" x="760" y="316" fill="#8b949e" font-size="9" text-anchor="middle">Summaries + Smart Planning</text>

  <!-- Flow: Backend -> Ollama -->
  <line class="flowv" x1="560" y1="274" x2="660" y2="295" stroke="#7c3aed" stroke-width="1.5" opacity="0.5"/>

  <!-- === FLOW: Autonomy -> Windows === -->
  <path class="flow" d="M 450 345 L 450 390 L 140 390 L 140 220" stroke="#7c3aed" stroke-width="1.5" opacity="0.5" fill="none"/>
  <text class="label" x="295" y="383" fill="#7c3aed" font-size="9" text-anchor="middle">PowerShell Actions</text>

  <!-- Bottom legend -->
  <g transform="translate(40, 395)">
    <line x1="0" y1="7" x2="20" y2="7" stroke="#0f8b8d" stroke-width="2"/>
    <text class="label" x="26" y="11" fill="#8b949e" font-size="9">Event flow</text>
    <line x1="100" y1="7" x2="120" y2="7" stroke="#7c3aed" stroke-width="1.5" stroke-dasharray="4 3"/>
    <text class="label" x="126" y="11" fill="#8b949e" font-size="9">Optional</text>
    <circle cx="200" cy="7" r="4" fill="#0f8b8d" opacity="0.6"/>
    <text class="label" x="210" y="11" fill="#8b949e" font-size="9">Active</text>
  </g>
</svg>
